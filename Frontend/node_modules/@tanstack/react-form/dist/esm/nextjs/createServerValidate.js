import { decode } from "decode-formdata";
import { ServerValidateError } from "./error.js";
const createServerValidate = (defaultOpts) => async (formData, info) => {
  const { validatorAdapter, onServerValidate } = defaultOpts;
  const runValidator = async (propsValue) => {
    if (validatorAdapter && typeof onServerValidate !== "function") {
      return validatorAdapter().validateAsync(propsValue, onServerValidate);
    }
    return onServerValidate(propsValue);
  };
  const values = decode(formData, info);
  const onServerError = await runValidator({ value: values });
  if (!onServerError) return;
  const formState = {
    errorMap: {
      onServer: onServerError
    },
    values,
    errors: onServerError ? [onServerError] : []
  };
  throw new ServerValidateError({
    formState
  });
};
const initialFormState = {
  errorMap: {
    onServer: void 0
  },
  values: void 0,
  errors: []
};
export {
  createServerValidate,
  initialFormState
};
//# sourceMappingURL=createServerValidate.js.map
